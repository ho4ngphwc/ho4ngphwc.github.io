---
layout: post
title:  "BYUCTF 2025"
date:   2025-23-05 22:00:00 +0700
tag: Writeup, BYUCTF
categories: jekyll update
---

# Wembsoncket

* Giao diá»‡n web

![image](https://hackmd.io/_uploads/Syht5Oa-ll.png)

MÃ¬nh Ä‘Æ°á»£c cung cáº¥p 1 source public.

Sau khi tÃ¬m hiá»ƒu Ä‘á»c thÃ¬ tháº¥y cÃ³ file quan trá»ng lÃ :
- `adminBot.js`
- `server.js` 

Trong file `adminBot.js` thÃ¬ khi mÃ¬nh gá»­i 1 URL há»£p lá»‡ thÃ¬ Bot sáº½ kiá»ƒm tra vÃ  click vÃ o cÃ¡i link cá»§a mÃ¬nh.

VÃ  khi Ä‘Ã³ nÃ³ sáº½ set cookie lÃ  `admin`.

![image](https://hackmd.io/_uploads/HyrHo_6Wgg.png)

MÃ  adminCookie Ä‘Æ°á»£c kÃ½ báº±ng `userId` lÃ  `admin`

![image](https://hackmd.io/_uploads/HJhPsO6-ex.png)

á» file `server.js`, thÃ¬ nÃ³ cÃ³ nhÆ° sau:
![image](https://hackmd.io/_uploads/ryx9i_aZgx.png)

Náº¿u mÃ¬nh gá»­i tá»›i endpoint `/getFlag` thÃ¬ nÃ³ sáº½ kiá»ƒm tra Ä‘Ãºng lÃ  `admin` thÃ¬ nÃ³ sáº½ tráº£ vá» flag 

BÃ i nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n káº¿t há»£p lÃ  XSS +  CSWSH (Cross-Site WebSocket Hijacking).

MÃ¬nh sáº½ cho bot nháº¥p link tá»« server mÃ¬nh host báº±ng `ngrok`, trong Ä‘Ã³ cÃ³ chá»©a 1 file fetch tá»›i endpoint `/getFlag`. 

NghÄ©a lÃ  khi truy cáº­p tá»›i endpoint `/getFlag` thÃ¬ chá»‰ cÃ³ bot má»›i nháº¥p Ä‘Æ°á»£c vÃ  sau Ä‘Ã³ nÃ³ tráº£ vá» trÃªn server cá»§a mÃ¬nh.

![image](https://hackmd.io/_uploads/rkUEaOaWxg.png)

Sau Ä‘Ã³ mÃ¬nh host báº±ng ngrok

![image](https://hackmd.io/_uploads/SkAST_pZxe.png)

Rá»“i Ä‘Æ°a link cho Bot

![image](https://hackmd.io/_uploads/Sk15p_aWeg.png)
Bot click thÃ nh cÃ´ng!

![image](https://hackmd.io/_uploads/Sygo6_p-ee.png)

Sau khi decode thÃ¬ Ä‘Æ°á»£c.

![image](https://hackmd.io/_uploads/rJ23TOT-eg.png)

`Flag : byuctf{CSWSH_1s_a_b1g_acr0nym}`

# JWTF 

* Giao diá»‡n web

![image](https://hackmd.io/_uploads/SkEEwuabeg.png)

NÃ³ tráº£ vá» `Hello World!` vÃ  cÅ©ng Ä‘Æ°á»£c cung cáº¥p 1 source public. 

BÃ i nÃ y Ä‘Æ°á»£c viáº¿t báº±ng python vÃ  xÃ¡c thá»±c ngÆ°á»i dÃ¹ng báº±ng JWT. 

ÄÆ°á»£c kÃ½ qua `APP_SECRET`, lÃ  1 chuá»—i sinh ra 1 chuá»—i random 32 kÃ½ tá»± Ä‘á»•i qua hex thÃ nh 64 kÃ½ tá»±. 

Cho nÃªn mÃ¬nh khÃ´ng thá»ƒ brute-force secret nÃ y Ä‘Æ°á»£c...

MÃ¬nh Ä‘Æ°á»£c cung cáº¥p 1 token há»£p lá»‡ trong `/jrl`

![image](https://hackmd.io/_uploads/rk_eduabxl.png)

Decode ra thÃ¬ Ä‘Æ°á»£c: 

![image](https://hackmd.io/_uploads/rJwz_Oabgx.png)

ThÃ¬ trong source cÃ³ logic nhÆ° sau: 

![image](https://hackmd.io/_uploads/BkJwuup-le.png)

á» endpoint nÃ y thÃ¬ mÃ¬nh khÃ´ng thá»ƒ dÃ¹ng Ä‘Æ°á»£c vÃ¬ pháº£i cÃ³ Ä‘Æ°á»£c token cá»§a admin vÃ  Ä‘Æ°á»£c kÃ½ báº±ng `SECRET_ADMIN` cho nÃªn lÃ  khÃ´ng thá»ƒ tÃ¬m Ä‘Æ°á»£c cÃ¡i secret Ä‘Ã³ Ä‘á»ƒ kÃ½ láº¡i. 

![image](https://hackmd.io/_uploads/HJR-Fd6bee.png)

CÃ²n endpoint nÃ y, á»Ÿ dÃ²ng 44 nÃ³ thá»±c hiá»‡n bá» dáº¥u `=` thÃ nh khoáº£ng trá»‘ng thÃ¬ nÃ y liÃªn quan Ä‘áº¿n Base64-encode vÃ  Base64URL-encode.

VÃ  nÃ³ kiá»ƒm tra ráº±ng náº¿u JWT Ä‘Ã³ cÃ³ payload lÃ  `admin` thÃ¬ tráº£ vá» flag. NhÆ°ng trÆ°á»›c Ä‘Ã³ cÃ³ Ä‘iá»u kiá»‡n lÃ  ko Ä‘Æ°á»£c lÃ  session trong /jrl nghÄ©a lÃ  ko Ä‘Æ°á»£c giá»‘ng. 

ThÃ¬ bÃ i nÃ y liÃªn quan Ä‘áº¿n 1 váº¥n Ä‘á» lÃ  sá»­a bit trong Base64URL-encode.

Ã tÆ°á»Ÿng Ä‘Æ°á»£c dá»±a vÃ o bÃ i viáº¿t nÃ y: [link](https://medium.com/%40mark_huber/decoding-the-jwt-anomaly-when-changing-a-tokens-last-character-doesn-t-break-verification-d6ab68627afb)

NÃªn sau khi tÃ­nh toÃ¡n thÃ¬ mÃ¬nh thay Ä‘á»•i kÃ½ tá»± cuá»‘i cÃ¹ng token lÃ  '`w`' thÃ nh '`x`' nghÄ©a lÃ  nÃ³ gáº§n nhau vÃ  viá»‡c thay Ä‘á»•i 1 bit cÅ©ng ko lÃ m áº£nh hÆ°á»Ÿng Ä‘áº¿n token gá»‘c.

![image](https://hackmd.io/_uploads/By1E9dpbex.png)

`Flag : byuctf{idk_if_this_means_anything_but_maybe_its_useful_somewhere_97ba5a70d94d}`

# Cooking Flask 

* Giao diá»‡n web 

![image](https://hackmd.io/_uploads/Sy19k_a-lx.png)

BÃ i nÃ y cÃ³ nhiá»u tham sá»‘ mÃ  cÃ²n cÃ³ lÆ°u thÃ´ng tin thÃ´ng qua tham sá»‘ `tag` nÃªn mÃ¬nh nghÄ© nÃ³ bá»‹ **SQLi**

NÃªn mÃ¬nh thá»­ thÃªm payload Ä‘áº§u tiÃªn Ä‘á»ƒ test lÃ  `'` vÃ o trong tham sá»‘ `tag`

![image](https://hackmd.io/_uploads/S1_5gda-xg.png)

NÃ³ nháº£y ra lá»—i nhÆ° sau: 

![image](https://hackmd.io/_uploads/rJssedTbge.png)

Váº­y thÃ¬ mÃ¬nh Ä‘oÃ¡n cÃ¢u query nhÆ° sau:
```bash=
SELECT <cai_gi_do> FROM <table_name> WHERE tag LIKE ('%<input>%')
```
Payload thá»© hai mÃ¬nh truyá»n vÃ o nhÆ° sau: 

![image](https://hackmd.io/_uploads/H107Zu6bee.png)

NÃ³ tráº£ vá» táº¥t cáº£ qua tham sá»‘ `tags`

![image](https://hackmd.io/_uploads/Bk4uWdpZxe.png)

Tá»« Ä‘Ã¢y mÃ¬nh cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh Ä‘Ã¢y cháº¯c cháº¯n lÃ  bug SQLi Error Base (String query)

## XÃ¡c Ä‘á»‹nh sá»‘ cá»™t trong cÃ¢u query gá»‘c

![image](https://hackmd.io/_uploads/HkYA-ua-gl.png)

NÃ³ tráº£ vá» lá»—i nhÆ° sau:
![image](https://hackmd.io/_uploads/HkU1M_pbel.png)

LÃ  `should be between 1 and 8`, nhÆ° váº­y lÃ  cÃ³ 8 cá»™t.

## XÃ¡c Ä‘á»‹nh cá»™t nÃ o cÃ³ thá»ƒ trÃ­ch xuáº¥t Ä‘Æ°á»£c thÃ´ng tin qua `UNION SELECT`

![image](https://hackmd.io/_uploads/B17wfuaWeg.png)

NÃ³ tráº£ vá» lÃ  cÃ¡c cá»™t trong cÃ¢u query cá»§a mÃ¬nh ko thá»ƒ lÃ  NULL.
![image](https://hackmd.io/_uploads/SyI_Mdable.png)

Cho nÃªn mÃ¬nh sáº½ thay **'a'** vÃ o tá»«ng cá»™t Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem cá»™t nÃ o lÃ  Chuá»—i.

Sau khi Ä‘á»c ká»¹ vÃ o thÃ¬ tháº¥y lá»—i tráº£ vá» lun cÃ¡c cá»™t trong cÃ¢u query ğŸ˜Š

![image](https://hackmd.io/_uploads/H1HWXdpZeg.png)

**recipe_id, recipe_name, date_created, recipe_image, recipe_description, instructions, tags, user_id = recipe_data**

Tá»« Ä‘Ã¢y mÃ¬nh Ä‘oÃ¡n nhÆ° sau:
- recipe_id --> INT 
- recipe_name --> STRING
- data_created --> DATE 
- recipe_image --> unknown
- recipe_description --> STRING
- intructions --> STRING 
- tags --> STRING (theo kiá»ƒu JSON)
- user_id = recipe_date --> INT 

NhÆ° váº­y mÃ¬nh truyá»n láº¡i nhÆ° sau:

![image](https://hackmd.io/_uploads/rJPNr_pZxg.png)

NhÆ° váº­y thÃ¬ mÃ¬nh Ä‘Ã£ truyá»n payload mÃ  nÃ³ Ä‘Ã£ tráº£ vá» cÃ¡c kÃ½ tá»± mÃ¬nh tá»± chÃ¨n vÃ o. 

NÃªn mÃ¬nh thá»±c hiá»‡n xem cÃ³ bao nhiÃªu table trong DB hiá»‡n táº¡i.

![image](https://hackmd.io/_uploads/HymArOT-eg.png)

MÃ¬nh tháº¥y cÃ³ table `user`, tiáº¿p tá»¥c khai thÃ¡c cá»™t trong table `user`. 

![image](https://hackmd.io/_uploads/r1KYUOTbxx.png)

MÃ¬nh tháº¥y cÃ³ cá»™t username vÃ  password nÃªn mÃ¬nh sáº½ trÃ­ch xuáº¥t xem cÃ³ gÃ¬. 

![image](https://hackmd.io/_uploads/S171D_T-el.png)

`Flag : byuctf{pl34s3_p4r4m3t3r1z3_y0ur_1nputs_4nd_h4sh_p4ssw0rds}`

# Willy Wonka Web

* Giao diá»‡n web 

![image](https://hackmd.io/_uploads/BkX9ivpZgx.png)

MÃ¬nh cÅ©ng Ä‘Æ°á»£c cung cáº¥p 1 source public. 

BÃ i nÃ y Ä‘Æ°á»£c xÃ¢y dá»±ng theo 1 mÃ´ hÃ¬nh: **Client --> Proxy --> Backend**

![image](https://hackmd.io/_uploads/SJu82Dabgx.png)

![image](https://hackmd.io/_uploads/SJKB3vaWxx.png)

Proxy Ä‘Æ°á»£c sá»­ dá»¥ng trong bÃ i nÃ y lÃ  `Apache`, nghÄ©a lÃ  khi client gá»­i kÃ¨m theo `http://url/name/test` --> Ä‘i qua proxy match vá»›i dÃ²ng 11 trong file `httpd.conf` nÃ³ sáº½ Ä‘Æ°á»£c truyá»n vÃ o theo `http://backend:3000/?name=test` 

![image](https://hackmd.io/_uploads/S1e23PT-xx.png)

CÃ²n trang tráº£ vá» **It works!** lÃ  trang máº·c Ä‘á»‹nh khi proxy ko tháº¥y rule nÃ o match nÃªn nÃ³ tráº£ vá» trang máº·c Ä‘á»‹nh. 

Äá»c trong file `Dockerfile` thÃ¬ mÃ¬nh tháº¥y cÃ³ config nhÆ° sau: 

![image](https://hackmd.io/_uploads/B1Rb6wTZlx.png)

NÃ³ dÃ¹ng `httpd:2.4.55`, nÃ³ liÃªn quan Ä‘áº¿n **CVE-2023-25690**.
BÃ i nÃ y khai thÃ¡c dá»±a trÃªn bÃ i github nÃ y: [link](https://github.com/thanhlam-attt/CVE-2023-25690)

Äáº§u tiÃªn mÃ¬nh sáº½ test xem nÃ³ cÃ³ cho thá»±c hiá»‡n CRLF (%0d%0a) hay ko? (%0d --> \r) vÃ  (%0a --> \n)

![image](https://hackmd.io/_uploads/rJYZ0DTbgx.png)

NghÄ©a lÃ  mÃ¬nh Ä‘Ã£ chÃ¨n 1 trÆ°á»ng `Foo: barr` vÃ o trong header

Sau khi decode header sáº½ Ä‘Æ°á»£c hiá»ƒu nhÆ° sau:

![image](https://hackmd.io/_uploads/r1LH0wp-ee.png)

Äá»c trong file `server.js` thÃ¬ mÃ¬nh tháº¥y Ä‘á»ƒ láº¥y Ä‘Æ°á»£c flag thÃ¬ pháº£i cÃ³ header lÃ  `a` hoáº·c `A` lÃ  `admin` thÃ¬ má»›i tráº£ vá» flag.

Cho nÃªn mÃ¬nh sáº½ thá»±c hiá»‡n `HTTP Request Smuggling`

![image](https://hackmd.io/_uploads/S1OmJuabgl.png)

Sau khi decode header thÃ¬ nÃ³ sáº½ nhÆ° sau: 

![image](https://hackmd.io/_uploads/BkNf1dpZgl.png)

`Flag : byuctf{i_never_liked_w1lly_wonka}`

# Red This

* Giao diá»‡n cá»§a web

![image](https://hackmd.io/_uploads/B1FTXvTZee.png)

MÃ¬nh Ä‘Æ°á»£c cung cáº¥p thÃªm 1 source public.
Sau khi Ä‘á»c source thÃ¬ phÃ¡t hiá»‡n ra thÃªm cÃ³ endpoint.
- **/login**
- **/register**

á» route `/` thÃ¬ mÃ¬nh cÃ³ cÃ¡c hÃ m Ä‘á»‹nh nghÄ©a nhÆ° sau:
![image](https://hackmd.io/_uploads/SJ_wVDp-gx.png)

Trong `root` cÃ³ `getAdminOptions` thÃ¬ hÃ m nÃ y tráº£ vá» theo dáº¡ng lÃ  `key => value`, dá»±a trÃªn `username` lÃ  `key`

VÃ  trong route `/get_quote`, á»Ÿ dÃ²ng 37 lÃ  xÃ¡c Ä‘á»‹nh `username` cá»§a ngÆ°á»i Ä‘ang thá»±c hiá»‡n, dÃ²ng 38 lÃ  láº¥y `famous_person` tá»« trong 1 cÃ¡i form vÃ  form cÃ³ chá»©a nhiá»u ná»™i dá»¥ng tá»« file `index.html`.

![image](https://hackmd.io/_uploads/H197Lv6Zle.png)

Sau Ä‘Ã³ dÃ²ng 39, biáº¿n `quote` sáº½ thá»ƒ hiá»‡n lÃ  danh sÃ¡ch chá»©a ná»™i dung thÃ´ng qua biáº¿n `person` Ä‘Ã£ Ä‘Æ°á»£c lÆ°u.
NghÄ©a lÃ  biáº¿n `person` Ä‘ang chá»©a cÃ¡c giÃ¡ trá»‹ cá»§a cÃ¡c tag `option`

á» dÃ²ng 40-43, thÃ¬ náº¿u `flag` náº±m trong list `person` thÃ¬ vÃ  `username` khÃ¡c `admin` thÃ¬ mÃ¬nh khÃ´ng láº¥y Ä‘Æ°á»£c flag.

á» dÃ²ng 44, náº¿u ko náº±m trong hai trÆ°á»ng há»£p trÃªn thÃ¬ `adminOptions` Ä‘Æ°á»£c gá»i tá»›i mÃ  `adminOptions` láº¡i tráº£ vá» theo dáº¡ng `key => value` náº¿u mÃ¬nh biáº¿t Ä‘Æ°á»£c `key` thÃ¬ cÃ³ thá»ƒ biáº¿t Ä‘Æ°á»£c `value`.


### Endpoint `/login`

![image](https://hackmd.io/_uploads/S1ct_D6Zxx.png)

á» dÃ²ng 89-90, thá»ƒ hiá»‡n cÃ¡ch check `username` vÃ  `password` trong database báº±ng hÃ m `getData()`. 
HÃ m nÃ y hoáº¡t Ä‘á»™ng theo kiá»ƒu `key => value`, dÃ²ng 90 dev Ä‘Ã£ lÆ°u `key` lÃ  `username_password`, thÃ¬ tá»« Ä‘Ã¢y mÃ¬nh Ä‘Ã£ biáº¿t Ä‘Æ°á»£c khÃ³a Ä‘á»ƒ lÆ°u password.

### Endpoint `/register`

![image](https://hackmd.io/_uploads/HkOo9PpWel.png)

á» dÃ²ng 70, dev cÅ©ng gá»£i Ã½ ra lÃ  `passwordKey` Ä‘Æ°á»£c lÆ°u theo dáº¡ng `username_password`

## Váº­y náº¿u mÃ¬nh truyá»n vÃ o key `admin_password` thÃ¬ `adminOptions` cÃ³ tráº£ vá» password ko? 

![image](https://hackmd.io/_uploads/SJnfqD6-lg.png)

NhÆ° váº­y mÃ¬nh Ä‘Ã£ láº¥y Ä‘Æ°á»£c credentials cá»§a admin lÃ  `admin:I_HopeYou4re8admin_iLoveTechn070g_9283910`

NhÆ° váº­y thÃ¬ mÃ¬nh Ä‘Ã£ cÃ³ thá»ƒ login vÃ o tÃ i khoáº£n admin.

![image](https://hackmd.io/_uploads/rkkGoPpZex.png)

`Flag : byuctf{al1w4ys_s2n1tize_1nput-5ed1s_eik4oc85nxz}`

